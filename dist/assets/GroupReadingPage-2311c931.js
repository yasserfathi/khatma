import{a2 as T,c as D,w as o,l as p,o as P,f as l,a as e,j as i,a5 as c,a8 as v,h as _,Q as y,d as b,e as j,C as h,ab as z,g as Q,aq as E,k as m}from"./index-776326c9.js";import{Q as w}from"./QTooltip-82c0d486.js";import{Q as $,a as C}from"./QTable-8e34d41f.js";import{Q as I}from"./QSpace-0963216b.js";import{Q as N}from"./QForm-ef212b9f.js";import{Q as U}from"./QPage-6bef6b9e.js";import{C as q}from"./ClosePopup-ef2d2dfb.js";import{S as n}from"./sweetalert2.esm.all-f6020d5c.js";import{_ as A}from"./_plugin-vue_export-helper-c27b6911.js";import"./position-engine-bd395f92.js";import"./format-ac96bbe5.js";import"./QLinearProgress-b4cb347b.js";import"./QChip-007a5e04.js";const F={class:"row items-center justify-between q-mb-lg"},M={class:"row items-center q-gutter-x-md"},H={class:"ellipsis-2-lines",style:{"max-width":"400px"}},J={class:"row justify-center q-gutter-x-sm"},K={class:"full-width row flex-center text-grey-6 q-pa-lg"},L={class:"text-h6 text-weight-bold"},O={class:"row justify-end q-mt-xl"},W={__name:"GroupReadingPage",setup(X){const x=m([]),f=m(!1),d=m(!1),u=m(!1),s=m({id:null,group_no:"",names:""}),V=[{name:"id",label:"#",field:"id",sortable:!0,align:"left",style:"width: 50px"},{name:"group_no",label:"رقم المجموعة",field:"group_no",sortable:!0,align:"center"},{name:"names",label:"الأسماء",field:"names",align:"right"},{name:"actions",label:"الإجراءات",field:"actions",align:"center",style:"width: 150px"}],g=async()=>{f.value=!0;try{const r=await p.get("/api/group-readings");x.value=r.data}catch(r){console.error("Error fetching group readings:",r),n.fire({icon:"error",title:"فشل التحميل",text:"حدث خطأ أثناء تحميل بيانات مجموعات القراءة"})}finally{f.value=!1}},B=()=>{u.value=!1,s.value={id:null,group_no:"",names:""},d.value=!0},k=r=>{u.value=!0,s.value={...r},d.value=!0},R=async()=>{try{u.value?(await p.put(`/api/group-readings/${s.value.id}`,s.value),n.fire({icon:"success",title:"تم التعديل",text:"تم التعديل بنجاح",timer:1500,showConfirmButton:!1})):(await p.post("/api/group-readings",s.value),n.fire({icon:"success",title:"تم الإنشاء",text:"تم الإنشاء بنجاح",timer:1500,showConfirmButton:!1})),d.value=!1,g()}catch(r){console.error("Error saving group reading:",r),n.fire({icon:"error",title:"خطأ",text:"حدث خطأ أثناء الحفظ"})}},S=r=>{n.fire({title:"تأكيد الحذف",text:"هل أنت متأكد من حذف هذه المجموعة؟",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"نعم، احذف",cancelButtonText:"إلغاء"}).then(async t=>{if(t.isConfirmed)try{await p.delete(`/api/group-readings/${r.id}`),n.fire("تم الحذف!","تم الحذف بنجاح.","success"),g()}catch(a){console.error("Error deleting:",a),n.fire({icon:"error",title:"خطأ",text:"فشل الحذف"})}})};return T(()=>{g()}),(r,t)=>(P(),D(U,{class:"q-pa-md"},{default:o(()=>[l("div",F,[l("div",M,[e(i,{round:"",flat:"",color:"primary",icon:"arrow_forward",to:"/app"}),t[3]||(t[3]=l("div",null,[l("div",{class:"text-h4 text-primary text-weight-bold text-islamic"},"مجموعات القراءة"),l("div",{class:"text-subtitle2 text-grey-7"},"إدارة أرقام المجموعات والأسماء المرتبطة بها")],-1))]),e(i,{unelevated:"",rounded:"",color:"primary",icon:"add",label:"مجموعة قراءة جديدة",onClick:B,class:"shadow-3 q-px-md"})]),e(y,{class:"glass-card q-pa-sm"},{default:o(()=>[e($,{rows:x.value,columns:V,"row-key":"id",loading:f.value,flat:"",separator:"none",class:"bg-transparent text-grey-9 custom-table","table-header-class":"text-primary text-weight-bold bg-primary-1 rounded-borders"},{"body-cell-names":o(a=>[e(C,{props:a},{default:o(()=>[l("div",H,[c(v(a.row.names)+" ",1),e(w,{anchor:"top middle",self:"bottom middle",offset:[10,10]},{default:o(()=>[c(v(a.row.names),1)]),_:2},1024)])]),_:2},1032,["props"])]),"body-cell-actions":o(a=>[e(C,{props:a,"auto-width":""},{default:o(()=>[l("div",J,[e(i,{flat:"",round:"",color:"primary",icon:"edit",size:"sm",class:"bg-primary-1 action-btn",onClick:G=>k(a.row)},{default:o(()=>[e(w,null,{default:o(()=>[...t[4]||(t[4]=[c("تعديل",-1)])]),_:1})]),_:1},8,["onClick"]),e(i,{flat:"",round:"",color:"red-7",icon:"delete",size:"sm",class:"bg-red-1 action-btn",onClick:G=>S(a.row)},{default:o(()=>[e(w,null,{default:o(()=>[...t[5]||(t[5]=[c("حذف",-1)])]),_:1})]),_:1},8,["onClick"])])]),_:2},1032,["props"])]),"no-data":o(()=>[l("div",K,[e(_,{name:"warning",size:"sm",class:"q-mr-sm"}),t[6]||(t[6]=c(" لا توجد بيانات حالياً ",-1))])]),_:1},8,["rows","loading"])]),_:1}),e(E,{modelValue:d.value,"onUpdate:modelValue":t[2]||(t[2]=a=>d.value=a),"transition-show":"scale","transition-hide":"scale"},{default:o(()=>[e(y,{style:{"min-width":"500px","border-radius":"20px"},class:"shadow-24 overflow-hidden"},{default:o(()=>[e(b,{class:"bg-primary text-white row items-center q-py-md q-px-lg"},{default:o(()=>[e(j,{icon:"menu_book",color:"primary-8","text-color":"white",size:"md",class:"q-mr-md"}),l("div",L,v(u.value?"تعديل مجموعة القراءة":"مجموعة قراءة جديدة"),1),e(I),h(e(i,{icon:"close",flat:"",round:"",dense:"",class:"text-white op-70 hover-op-100"},null,512),[[q]])]),_:1}),e(z,{color:"primary-10"}),e(b,{class:"q-pa-lg"},{default:o(()=>[e(N,{onSubmit:R,class:"q-gutter-md"},{default:o(()=>[e(Q,{filled:"",dense:"",modelValue:s.value.group_no,"onUpdate:modelValue":t[0]||(t[0]=a=>s.value.group_no=a),label:"رقم المجموعة",color:"primary","bg-color":"grey-1",class:"rounded-borders",rules:[a=>!!a||"يرجى إدخال رقم المجموعة"],placeholder:"مثال: 101"},{prepend:o(()=>[e(_,{name:"number",color:"primary"})]),_:1},8,["modelValue","rules"]),e(Q,{filled:"",dense:"",type:"textarea",modelValue:s.value.names,"onUpdate:modelValue":t[1]||(t[1]=a=>s.value.names=a),label:"الأسماء",color:"primary","bg-color":"grey-1",class:"rounded-borders",rules:[a=>!!a||"يرجى إدخال الأسماء"],placeholder:"أدخل الأسماء هنا..."},{prepend:o(()=>[e(_,{name:"people",color:"primary"})]),_:1},8,["modelValue","rules"]),l("div",O,[h(e(i,{label:"إلغاء",color:"grey-7",flat:"",class:"q-mr-sm"},null,512),[[q]]),e(i,{label:u.value?"حفظ التغييرات":"إنشاء",type:"submit",color:"primary",icon:"save",unelevated:"",class:"q-px-lg shadow-2",style:{"border-radius":"10px"}},null,8,["label"])])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}},ce=A(W,[["__scopeId","data-v-907c7545"]]);export{ce as default};
